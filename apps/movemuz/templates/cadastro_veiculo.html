{% extends 'base.html' %}
{% load static %}

{% block title %}Cadastro de Veículo - Seu Projeto{% endblock %}

{% block content %}
<h1 class="text-center mb-4">Cadastro de Veículo</h1>

<form action="{% url 'cadastrar_veiculo' %}" method="post" enctype="multipart/form-data">
    {% csrf_token %}
    <h2 class="mb-4 fw-semibold text-center border-bottom pb-2">Detalhes do Veículo</h2>
    <div class="row g-4">

        <div class="col-12">
            <div class="form-floating">
                <input type="text" class="form-control" id="id_modelo" name="modelo" placeholder="Modelo" required>
                <label for="id_modelo">Modelo</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <input type="text" class="form-control" id="id_placa" name="placa" placeholder="Placa" maxlength="7" required>
                <label for="id_placa">Placa (7 caracteres)</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <input type="text" class="form-control" id="id_cor" name="cor" placeholder="Cor" required>
                <label for="id_cor">Cor</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <input type="number" class="form-control" id="id_ano_fabricacao" name="ano_fabricacao" placeholder="Ano de Fabricação" required min="1900" max="{{ current_year }}">
                <label for="id_ano_fabricacao">Ano de Fabricação</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <select class="form-select" id="id_tipo" name="tipo" required>
                  <option value="" selected disabled>Selecione um tipo</option>
                  {% for tipo in tipos_veiculo %}
                    <option value="{{ tipo.pk }}">{{ tipo.nome }}</option>
                  {% endfor %}
                </select>
                <label for="id_tipo">Tipo de Veículo</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <select class="form-select" id="id_combustivel" name="combustivel" required>
                  <option value="" selected disabled>Selecione um combustível</option>
                  {% for combustivel in combustiveis %}
                    <option value="{{ combustivel.pk }}">{{ combustivel.nome }}</option>
                  {% endfor %}
                </select>
                <label for="id_combustivel">Combustível</label>
            </div>
        </div>

        <div class="col-12">
            <div class="form-floating">
                <input type="number" class="form-control" id="id_capacidade" name="capacidade" placeholder="Capacidade" min="1">
                <label for="id_capacidade">Capacidade (Passageiros/Carga)</label>
            </div>
        </div>

        <div class="col-12">
            <label class="form-label fw-semibold">Condição de Manutenção:</label>
            <div class="d-flex flex-wrap gap-3">
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="condicao_manutencao" id="condicao_bom" value="bom" checked>
                  <label class="form-check-label" for="condicao_bom">Bom</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="condicao_manutencao" id="condicao_regular" value="regular">
                  <label class="form-check-label" for="condicao_regular">Regular</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="condicao_manutencao" id="condicao_manutencao" value="manutencao">
                  <label class="form-check-label" for="condicao_manutencao">Em manutenção</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="radio" name="condicao_manutencao" id="condicao_inativo" value="inativo">
                  <label class="form-check-label" for="condicao_inativo">Inativo</label>
                </div>
            </div>
        </div>

        <div class="col-12">
            <label for="id_foto" class="form-label">Foto do Veículo</label>
            <input class="form-control" type="file" id="id_foto" name="foto" accept="image/*">
        </div>

        <div class="col-12 text-center">
          <button class="btn btn-verde-principal px-5" type="submit">Enviar</button>
        </div>
    </div>
</form>
{% endblock %}

{% block extra_js %}
<script>
    document.addEventListener('DOMContentLoaded', function() {
        const currentYear = new Date().getFullYear();
        const yearInput = document.getElementById('id_ano_fabricacao');
        if (yearInput) {
            yearInput.setAttribute('max', currentYear);
        }
    });
</script>
{% endblock %}